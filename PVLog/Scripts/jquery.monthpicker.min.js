/**
* monthPicker - a simple but useful month/year picker 
* this plugin creates two selectboxes where the user can can select month and year. afterwars a unix-timestamp is written into the
* original input field.
* 
* Copyright (c) Dirk Diebel <http://www.phpmedia.de/>.
* Released under MIT License
* 
* 
* <usage>
* 
* 	$('#id-selector').monthpicker([options]);
*  
* [options] accepts following JSON properties:
*  minYear - the minimum year the selectbox should show
*  maxYear  - the maximum year the selectbox should show
*  month    - a map of month labels
*		f.e. german months
*		month : ['January','Februar','März','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember']  
* </usage>
* 
* 
* @author Dirk Diebel
* @version 1.0
* @date August 12, 2010
* @edited Patrick Epstein 2012-01-26
*/
(function ($) {
  $.fn.monthYearPicker = function (options) {

    var defaults = {
      yearPickerOnly: false,
      minYear: "2010",
      maxYear: new Date().getFullYear(),
      month: ['Januar', 'Februar', 'März', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'],
      defaultYear: new Date().getFullYear(),
      defaultMonth: new Date().getMonth(),
      onChange: undefined
    };
    var options = $.extend(defaults, options);

    var yearbox;
    var monthbox;
    var obj = $(this);

    if (!options.yearPickerOnly) {
      $.map(options.month, function (n, i) {
        if (options.defaultMonth != i)
          monthbox += '<option value="' + (i + 1) + '">' + n + '</option>';
        else
          monthbox += '<option value="' + (i + 1) + '" selected="selected">' + n + '</option>';
      });

      var monthElement = $('<select class="monthpick">' + monthbox + '</select>');
      monthElement.appendTo($(this));
    }


    if (options.minYear > options.maxYear) {
      for (var i = options.minYear; i >= options.maxYear; i--) {
        yearbox += '<option value="' + i + '">' + i + '</option>';
      }
    } else {
      for (var i = options.minYear; i <= options.maxYear; i++) {
        if (options.defaultYear != i)
          yearbox += '<option value="' + i + '">' + i + '</option>';
        else
          yearbox += '<option value="' + i + '" selected="selected">' + i + '</option>';
      }
    }

    var yearElement = $('<select class="yearpick">' + yearbox + '</select>');
    yearElement.appendTo($(this));




    $(this).children().change(function () {

      if ($.isFunction(options.onChange)) {
        options.onChange();
      }

    });

  };
})(jQuery);